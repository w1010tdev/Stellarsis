{% extends "base.html" %}

{% block additional_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
{% endblock %}

{% block content %}
<div class="homepage-layout">
    <div class="quote-section">
        <div class="quote-module">
            <div class="quote-text">{{ selected_quote.split(' - ')[0] }}</div>
            <div class="quote-author">- {{ selected_quote.split(' - ')[1] if '-' in selected_quote else '' }}</div>
        </div>
    </div>
    
    <div class="unread-section">
        <div class="unread-container">
            <h2 class="section-title">未读聊天室</h2>
            
            {% if accessible_rooms %}
                <div class="rooms-grid">
                    {% for room in accessible_rooms %}
                        {% set unread_count = chat_counts.get(room.id, 0) %}
                        <div class="room-card">
                            <div class="room-card-header">
                                <h3>{{ room.name }}</h3>
                                {% if unread_count > 0 %}
                                    <span class="unread-badge" title="未读消息">{{ unread_count }}</span>
                                {% endif %}
                            </div>
                            <p class="room-description">{{ room.description or '暂无描述' }}</p>
                            <div class="room-actions">
                                <a href="{{ url_for('chat_room', room_id=room.id) }}" class="btn">进入</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <p>暂无可访问的聊天室</p>
                </div>
            {% endif %}
            
            <h2 class="section-title">未读贴吧分区</h2>
            
            {% if accessible_sections %}
                <div class="rooms-grid">
                    {% for section in accessible_sections %}
                        {% set unread_count = forum_counts.get(section.id, 0) %}
                        <div class="room-card">
                            <div class="room-card-header">
                                <h3>{{ section.name }}</h3>
                                {% if unread_count > 0 %}
                                    <span class="unread-badge" title="未读消息">{{ unread_count }}</span>
                                {% endif %}
                            </div>
                            <p class="room-description">{{ section.description or '暂无描述' }}</p>
                            <div class="room-actions">
                                <a href="{{ url_for('forum_section', section_id=section.id) }}" class="btn">进入</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <p>暂无可访问的贴吧分区</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>


{% endblock %}